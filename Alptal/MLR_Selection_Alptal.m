%{
Collect ingredients necessary for multi-linear regression.
- emissivity of the sky & solar angle -> description of meteorological
  conditions (insolation doesn't translate from simulation to simulation
  because of differences in latitude and season, and it's also depending on
  cloudiness)
%}
% select evaluation period
EP_2004 = start_2004+18:1728;
EP_2005 = 25:1752;
EP_2006 = 25:1872;
EP_2007 = 25:2256;
% consider gaps of evaluation data (snow on radiometer)
    % 2004
gap_2004_1 = 601:624;           % 25 January 2004
gap_2004_2 = 1009:1032;         % 11 February 2004
gap_2004_3 = 1201:1224;         % 19 February 2004
gap_2004_4 = 1633:1728;         % 8 - 11 March 2004
    % 2005
gap_2005_1 = 553:624;           % 23 - 25 January 2005
gap_2005_2 = 769:792;           % 1 February 2005
gap_2005_3 = 1057:1272;         % 13 - 21 February 2005
gap_2005_4 = 1609:1656;         % 8 - 9 March 2005
    % 2006
gap_2006 = 937:1032;            % 8 - 11 February 2006           
    % 2007
gap_2007_1 = 49:96;             % 2 - 3 January 2007
gap_2007_2 = 1873:2016;         % 19 - 24 March 2007

% select variables
LAI_Alptal = LAI;
PAI_Alptal = LAI + SAI;

% 2004
Hourly_Time_Alptal_2004 = vertcat(time_1h_all(EP_2004(1):gap_2004_1(1)-1,1),...
    time_1h_all(gap_2004_1(end)+1:gap_2004_2(1)-1,1),...
    time_1h_all(gap_2004_2(end)+1:gap_2004_3(1)-1,1),...
    time_1h_all(gap_2004_3(end)+1:gap_2004_4(1)-1,1),...
    time_1h_all(gap_2004_4(end)+1:EP_2004(end),1));
Cosine_Solar_Angle_Alptal_2004 = vertcat(Cosine_Solar_Angle(EP_2004(1):gap_2004_1(1)-1,1),...
    Cosine_Solar_Angle(gap_2004_1(end)+1:gap_2004_2(1)-1,1),...
    Cosine_Solar_Angle(gap_2004_2(end)+1:gap_2004_3(1)-1,1),...
    Cosine_Solar_Angle(gap_2004_3(end)+1:gap_2004_4(1)-1,1),...
    Cosine_Solar_Angle(gap_2004_4(end)+1:EP_2004(end),1));
SWR_Incoming_Alptal_2004 = vertcat(SW_In_Above_Vegetation(EP_2004(1):gap_2004_1(1)-1,1),...
    SW_In_Above_Vegetation(gap_2004_1(end)+1:gap_2004_2(1)-1,1),...
    SW_In_Above_Vegetation(gap_2004_2(end)+1:gap_2004_3(1)-1,1),...
    SW_In_Above_Vegetation(gap_2004_3(end)+1:gap_2004_4(1)-1,1),...
    SW_In_Above_Vegetation(gap_2004_4(end)+1:EP_2004(end),1));
LWR_Atmosphere_Alptal_2004 = vertcat(LW_In_Above_Vegetation(EP_2004(1):gap_2004_1(1)-1,1),...
    LW_In_Above_Vegetation(gap_2004_1(end)+1:gap_2004_2(1)-1,1),...
    LW_In_Above_Vegetation(gap_2004_2(end)+1:gap_2004_3(1)-1,1),...
    LW_In_Above_Vegetation(gap_2004_3(end)+1:gap_2004_4(1)-1,1),...
    LW_In_Above_Vegetation(gap_2004_4(end)+1:EP_2004(end),1));

bla = 5.67*10^(-8)*Air_Temperature_Above_Vegetation(:,1).^4;
blub = LW_In_Above_Vegetation(:,1)./bla;
Sky_Emissivity_Alptal_2004 = vertcat(blub(EP_2004(1):gap_2004_1(1)-1),...
    blub(gap_2004_1(end)+1:gap_2004_2(1)-1),...
    blub(gap_2004_2(end)+1:gap_2004_3(1)-1),...
    blub(gap_2004_3(end)+1:gap_2004_4(1)-1),...
    blub(gap_2004_4(end)+1:EP_2004(end)));
clear bla blub

LWR_Subcanopy_Observations_Alptal_2004 = vertcat(LW_in_bc_1h_all(EP_2004(1):gap_2004_1(1)-1,1),...
    LW_in_bc_1h_all(gap_2004_1(end)+1:gap_2004_2(1)-1,1),...
    LW_in_bc_1h_all(gap_2004_2(end)+1:gap_2004_3(1)-1,1),...
    LW_in_bc_1h_all(gap_2004_3(end)+1:gap_2004_4(1)-1,1),...
    LW_in_bc_1h_all(gap_2004_4(end)+1:EP_2004(end),1));
LWR_Subcanopy_CLM_Alptal_2004 = vertcat(LW_in_bc_CLM(EP_2004(1):gap_2004_1(1)-1,1),...
    LW_in_bc_CLM(gap_2004_1(end)+1:gap_2004_2(1)-1,1),...
    LW_in_bc_CLM(gap_2004_2(end)+1:gap_2004_3(1)-1,1),...
    LW_in_bc_CLM(gap_2004_3(end)+1:gap_2004_4(1)-1,1),...
    LW_in_bc_CLM(gap_2004_4(end)+1:EP_2004(end),1));


% 2005
Hourly_Time_Alptal_2005 = vertcat(time_1h_all(EP_2005(1):gap_2005_1(1)-1,2),...
    time_1h_all(gap_2005_1(end)+1:gap_2005_2(1)-1,2),...
    time_1h_all(gap_2005_2(end)+1:gap_2005_3(1)-1,2),...
    time_1h_all(gap_2005_3(end)+1:gap_2005_4(1)-1,2),...
    time_1h_all(gap_2005_4(end)+1:EP_2005(end),2));
Cosine_Solar_Angle_Alptal_2005 = vertcat(Cosine_Solar_Angle(EP_2005(1):gap_2005_1(1)-1,2),...
    Cosine_Solar_Angle(gap_2005_1(end)+1:gap_2005_2(1)-1,2),...
    Cosine_Solar_Angle(gap_2005_2(end)+1:gap_2005_3(1)-1,2),...
    Cosine_Solar_Angle(gap_2005_3(end)+1:gap_2005_4(1)-1,2),...
    Cosine_Solar_Angle(gap_2005_4(end)+1:EP_2005(end),2));
SWR_Incoming_Alptal_2005 = vertcat(SW_In_Above_Vegetation(EP_2005(1):gap_2005_1(1)-1,2),...
    SW_In_Above_Vegetation(gap_2005_1(end)+1:gap_2005_2(1)-1,2),...
    SW_In_Above_Vegetation(gap_2005_2(end)+1:gap_2005_3(1)-1,2),...
    SW_In_Above_Vegetation(gap_2005_3(end)+1:gap_2005_4(1)-1,2),...
    SW_In_Above_Vegetation(gap_2005_4(end)+1:EP_2005(end),2));
LWR_Atmosphere_Alptal_2005 = vertcat(LW_In_Above_Vegetation(EP_2005(1):gap_2005_1(1)-1,2),...
    LW_In_Above_Vegetation(gap_2005_1(end)+1:gap_2005_2(1)-1,2),...
    LW_In_Above_Vegetation(gap_2005_2(end)+1:gap_2005_3(1)-1,2),...
    LW_In_Above_Vegetation(gap_2005_3(end)+1:gap_2005_4(1)-1,2),...
    LW_In_Above_Vegetation(gap_2005_4(end)+1:EP_2005(end),2));

bla = 5.67*10^(-8)*Air_Temperature_Above_Vegetation(:,2).^4;
blub = LW_In_Above_Vegetation(:,2)./bla;
Sky_Emissivity_Alptal_2005 = vertcat(blub(EP_2005(1):gap_2005_1(1)-1),...
    blub(gap_2005_1(end)+1:gap_2005_2(1)-1),...
    blub(gap_2005_2(end)+1:gap_2005_3(1)-1),...
    blub(gap_2005_3(end)+1:gap_2005_4(1)-1),...
    blub(gap_2005_4(end)+1:EP_2005(end)));
clear bla blub

LWR_Subcanopy_Observations_Alptal_2005 = vertcat(LW_in_bc_1h_all(EP_2005(1):gap_2005_1(1)-1,2),...
    LW_in_bc_1h_all(gap_2005_1(end)+1:gap_2005_2(1)-1,2),...
    LW_in_bc_1h_all(gap_2005_2(end)+1:gap_2005_3(1)-1,2),...
    LW_in_bc_1h_all(gap_2005_3(end)+1:gap_2005_4(1)-1,2),...
    LW_in_bc_1h_all(gap_2005_4(end)+1:EP_2005(end),2));
LWR_Subcanopy_CLM_Alptal_2005 = vertcat(LW_in_bc_CLM(EP_2005(1):gap_2005_1(1)-1,2),...
    LW_in_bc_CLM(gap_2005_1(end)+1:gap_2005_2(1)-1,2),...
    LW_in_bc_CLM(gap_2005_2(end)+1:gap_2005_3(1)-1,2),...
    LW_in_bc_CLM(gap_2005_3(end)+1:gap_2005_4(1)-1,2),...
    LW_in_bc_CLM(gap_2005_4(end)+1:EP_2005(end),2));

% 2006
Hourly_Time_Alptal_2006 = vertcat(time_1h_all(EP_2006(1):gap_2006(1)-1,3),...
    time_1h_all(gap_2006(end)+1:EP_2006(end),3));
Cosine_Solar_Angle_Alptal_2006 = vertcat(Cosine_Solar_Angle(EP_2006(1):gap_2006(1)-1,3),...
    Cosine_Solar_Angle(gap_2006(end)+1:EP_2006(end),3));
SWR_Incoming_Alptal_2006 = vertcat(SW_In_Above_Vegetation(EP_2006(1):gap_2006(1)-1,3),...
    SW_In_Above_Vegetation(gap_2006(end)+1:EP_2006(end),3));
LWR_Atmosphere_Alptal_2006 = vertcat(LW_In_Above_Vegetation(EP_2006(1):gap_2006(1)-1,3),...
    LW_In_Above_Vegetation(gap_2006(end)+1:EP_2006(end),3));

bla = 5.67*10^(-8)*Air_Temperature_Above_Vegetation(:,3).^4;
blub = LW_In_Above_Vegetation(:,3)./bla;
Sky_Emissivity_Alptal_2006 = vertcat(blub(EP_2006(1):gap_2006(1)-1),...
    blub(gap_2006(end)+1:EP_2006(end)));
clear bla blub

LWR_Subcanopy_Observations_Alptal_2006 = vertcat(LW_in_bc_1h_all(EP_2006(1):gap_2006(1)-1,3),...
    LW_in_bc_1h_all(gap_2006(end)+1:EP_2006(end),3));
LWR_Subcanopy_CLM_Alptal_2006 = vertcat(LW_in_bc_CLM(EP_2006(1):gap_2006(1)-1,3),...
    LW_in_bc_CLM(gap_2006(end)+1:EP_2006(end),3));

% 2007
Hourly_Time_Alptal_2007 = vertcat(time_1h_all(EP_2007(1):gap_2007_1(1)-1,4),...
    time_1h_all(gap_2007_1(end)+1:gap_2007_2(1)-1,4),...
    time_1h_all(gap_2007_2(end)+1:EP_2007(end),4));
Cosine_Solar_Angle_Alptal_2007 = vertcat(Cosine_Solar_Angle(EP_2007(1):gap_2007_1(1)-1,4),...
    Cosine_Solar_Angle(gap_2007_1(end)+1:gap_2007_2(1)-1,4),...
    Cosine_Solar_Angle(gap_2007_2(end)+1:EP_2007(end),4));
SWR_Incoming_Alptal_2007 = vertcat(SW_In_Above_Vegetation(EP_2007(1):gap_2007_1(1)-1,4),...
    SW_In_Above_Vegetation(gap_2007_1(end)+1:gap_2007_2(1)-1,4),...
    SW_In_Above_Vegetation(gap_2007_2(end)+1:EP_2007(end),4));
LWR_Atmosphere_Alptal_2007 = vertcat(LW_In_Above_Vegetation(EP_2007(1):gap_2007_1(1)-1,4),...
    LW_In_Above_Vegetation(gap_2007_1(end)+1:gap_2007_2(1)-1,4),...
    LW_In_Above_Vegetation(gap_2007_2(end)+1:EP_2007(end),4));

bla = 5.67*10^(-8)*Air_Temperature_Above_Vegetation(:,4).^4;
blub = LW_In_Above_Vegetation(:,4)./bla;
Sky_Emissivity_Alptal_2007 = vertcat(blub(EP_2007(1):gap_2007_1(1)-1),...
    blub(gap_2007_1(end)+1:gap_2007_2(1)-1),...
    blub(gap_2007_2(end)+1:EP_2007(end)));
clear bla blub

LWR_Subcanopy_Observations_Alptal_2007 = vertcat(LW_in_bc_1h_all(EP_2007(1):gap_2007_1(1)-1,4),...
    LW_in_bc_1h_all(gap_2007_1(end)+1:gap_2007_2(1)-1,4),...
    LW_in_bc_1h_all(gap_2007_2(end)+1:EP_2007(end),4));
LWR_Subcanopy_CLM_Alptal_2007 = vertcat(LW_in_bc_CLM(EP_2007(1):gap_2007_1(1)-1,4),...
    LW_in_bc_CLM(gap_2007_1(end)+1:gap_2007_2(1)-1,4),...
    LW_in_bc_CLM(gap_2007_2(end)+1:EP_2007(end),4));


save('MLRdata_Alptal.mat','LAI_Alptal','PAI_Alptal','Hourly_Time_Alptal_2004',...
    'Hourly_Time_Alptal_2005','Hourly_Time_Alptal_2006','Hourly_Time_Alptal_2007',...
    'Cosine_Solar_Angle_Alptal_2004','Cosine_Solar_Angle_Alptal_2005',...
    'Cosine_Solar_Angle_Alptal_2006','Cosine_Solar_Angle_Alptal_2007',...
    'SWR_Incoming_Alptal_2004','SWR_Incoming_Alptal_2005',...
    'SWR_Incoming_Alptal_2006','SWR_Incoming_Alptal_2007',...
    'LWR_Atmosphere_Alptal_2004','LWR_Atmosphere_Alptal_2005',...
    'LWR_Atmosphere_Alptal_2006','LWR_Atmosphere_Alptal_2007',...
    'Sky_Emissivity_Alptal_2004','Sky_Emissivity_Alptal_2005',...
    'Sky_Emissivity_Alptal_2006','Sky_Emissivity_Alptal_2007',...
    'LWR_Subcanopy_Observations_Alptal_2004','LWR_Subcanopy_Observations_Alptal_2005',...
    'LWR_Subcanopy_Observations_Alptal_2006','LWR_Subcanopy_Observations_Alptal_2007',...
    'LWR_Subcanopy_CLM_Alptal_2004','LWR_Subcanopy_CLM_Alptal_2005',...
    'LWR_Subcanopy_CLM_Alptal_2006','LWR_Subcanopy_CLM_Alptal_2007')