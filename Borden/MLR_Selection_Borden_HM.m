%----------------------  select evaluation periods  ----------------------%
%{
Simulation starts on 1 January 2013 11:00, so evaluation periods start on 1
January at 1:00. Meltout estimated via surface albedo happens at 18:00 on 4 
April, so evaluation period ends at 0:00 on 4 April.
%}
EP_start = 25;
EP_end = 2232;

%{
Gaps in radiometer data.
%}
gap_LW_1 = 649:696;     % 28 Jan 1:00 to 30 Jan 0:00
gap_LW_2 = 985:1008;    % 11 Feb 1:00 to 12 Feb 0:00
gap_LW_3 = 1057:1080;   % 14 Feb 1:00 to 15 Feb 0:00
gap_LW_4 = 1273:1296;   % 23 Feb 1:00 to 24 Feb 0:00
% gap_LW_5 = 1345:1392;   % 26 Feb 1:00 to 28 Feb 0:00 - included in snow
% gap_LW_6 = 1369:1416;   % 31 Mar 1:00 to 1 Mar 0:00
gap_LW_7 = 1585:1608;   % 8 Mar 1:00 to 9 Mar 0:00
gap_LW_8 = 2425:2448;   % 12 Apr 1:00 to 13 Apr 0:00

%{
Suspicious values of constant LWR around 314.3 W m^{-2}, indicating snow 
cover on radiometers, set to nan. Complete days around those timesteps are
excluded.
We extend gap #1 to include both LW gaps #5 and #6.
%}
% gap_snow_1 = 1321:1392;   % 25 Feb 1:00 to 28 Feb 0:00
gap_snow_1 = 1321:1416;   % 25 Feb 1:00 to 28 Feb 0:00
gap_snow_2 = 1969:1992;   % 24 Mar 1:00 to 25 Mar 0:00
gap_snow_3 = 2137:2160;   % 31 Mar 1:00 to 1 Apr 0:00

%{
Gap in meteorological forcing from 0:00 to 9:00 on 1 February, which,
unfortunately, means we have to exclude both 31 January and 1 February.
%}
gap_met = 721:768;


%--------------------------  cut out variables  --------------------------%
LAI_Borden = LAI;
PAI_Borden = LAI + SAI;
Hourly_Time_Borden = horzcat(time_1h(EP_start:gap_LW_1(1)-1),...
    time_1h(gap_LW_1(end)+1:gap_met(1)-1),...
    time_1h(gap_met(end)+1:gap_LW_2(1)-1),...
    time_1h(gap_LW_2(end)+1:gap_LW_3(1)-1),...
    time_1h(gap_LW_3(end)+1:gap_LW_4(1)-1),...
    time_1h(gap_LW_4(end)+1:gap_snow_1(1)-1),...
    time_1h(gap_snow_1(end)+1:gap_LW_7(1)-1),...
    time_1h(gap_LW_7(end)+1:gap_snow_2(1)-1),...
    time_1h(gap_snow_2(end)+1:gap_snow_3(1)-1),...
    time_1h(gap_snow_3(end)+1:gap_LW_8(1)-1),...
    time_1h(gap_LW_8(end)+1:EP_end));
Cosine_Solar_Angle_Borden = horzcat(Cosine_Solar_Angle(EP_start:gap_LW_1(1)-1),...
    Cosine_Solar_Angle(gap_LW_1(end)+1:gap_met(1)-1),...
    Cosine_Solar_Angle(gap_met(end)+1:gap_LW_2(1)-1),...
    Cosine_Solar_Angle(gap_LW_2(end)+1:gap_LW_3(1)-1),...
    Cosine_Solar_Angle(gap_LW_3(end)+1:gap_LW_4(1)-1),...
    Cosine_Solar_Angle(gap_LW_4(end)+1:gap_snow_1(1)-1),...
    Cosine_Solar_Angle(gap_snow_1(end)+1:gap_LW_7(1)-1),...
    Cosine_Solar_Angle(gap_LW_7(end)+1:gap_snow_2(1)-1),...
    Cosine_Solar_Angle(gap_snow_2(end)+1:gap_snow_3(1)-1),...
    Cosine_Solar_Angle(gap_snow_3(end)+1:gap_LW_8(1)-1),...
    Cosine_Solar_Angle(gap_LW_8(end)+1:EP_end));
SWR_Incoming_Borden = horzcat(SW_In_Above_Vegetation(EP_start:gap_LW_1(1)-1),...
    SW_In_Above_Vegetation(gap_LW_1(end)+1:gap_met(1)-1),...
    SW_In_Above_Vegetation(gap_met(end)+1:gap_LW_2(1)-1),...
    SW_In_Above_Vegetation(gap_LW_2(end)+1:gap_LW_3(1)-1),...
    SW_In_Above_Vegetation(gap_LW_3(end)+1:gap_LW_4(1)-1),...
    SW_In_Above_Vegetation(gap_LW_4(end)+1:gap_snow_1(1)-1),...
    SW_In_Above_Vegetation(gap_snow_1(end)+1:gap_LW_7(1)-1),...
    SW_In_Above_Vegetation(gap_LW_7(end)+1:gap_snow_2(1)-1),...
    SW_In_Above_Vegetation(gap_snow_2(end)+1:gap_snow_3(1)-1),...
    SW_In_Above_Vegetation(gap_snow_3(end)+1:gap_LW_8(1)-1),...
    SW_In_Above_Vegetation(gap_LW_8(end)+1:EP_end));
LWR_Atmosphere_Borden = horzcat(LW_In_Above_Vegetation(EP_start:gap_LW_1(1)-1),...
    LW_In_Above_Vegetation(gap_LW_1(end)+1:gap_met(1)-1),...
    LW_In_Above_Vegetation(gap_met(end)+1:gap_LW_2(1)-1),...
    LW_In_Above_Vegetation(gap_LW_2(end)+1:gap_LW_3(1)-1),...
    LW_In_Above_Vegetation(gap_LW_3(end)+1:gap_LW_4(1)-1),...
    LW_In_Above_Vegetation(gap_LW_4(end)+1:gap_snow_1(1)-1),...
    LW_In_Above_Vegetation(gap_snow_1(end)+1:gap_LW_7(1)-1),...
    LW_In_Above_Vegetation(gap_LW_7(end)+1:gap_snow_2(1)-1),...
    LW_In_Above_Vegetation(gap_snow_2(end)+1:gap_snow_3(1)-1),...
    LW_In_Above_Vegetation(gap_snow_3(end)+1:gap_LW_8(1)-1),...
    LW_In_Above_Vegetation(gap_LW_8(end)+1:EP_end));

bla = 5.67*10^(-8)*Air_Temperature_Above_Vegetation.^4;
blub = LW_In_Above_Vegetation./bla;
Sky_Emissivity_Borden = horzcat(blub(EP_start:gap_LW_1(1)-1),...
    blub(gap_LW_1(end)+1:gap_met(1)-1),...
    blub(gap_met(end)+1:gap_LW_2(1)-1),...
    blub(gap_LW_2(end)+1:gap_LW_3(1)-1),...
    blub(gap_LW_3(end)+1:gap_LW_4(1)-1),...
    blub(gap_LW_4(end)+1:gap_snow_1(1)-1),...
    blub(gap_snow_1(end)+1:gap_LW_7(1)-1),...
    blub(gap_LW_7(end)+1:gap_snow_2(1)-1),...
    blub(gap_snow_2(end)+1:gap_snow_3(1)-1),...
    blub(gap_snow_3(end)+1:gap_LW_8(1)-1),...
    blub(gap_LW_8(end)+1:EP_end));
clear bla blub

LWR_Subcanopy_Observations_Borden = horzcat(LW_in_bc_1h(EP_start:gap_LW_1(1)-1),...
    LW_in_bc_1h(gap_LW_1(end)+1:gap_met(1)-1),...
    LW_in_bc_1h(gap_met(end)+1:gap_LW_2(1)-1),...
    LW_in_bc_1h(gap_LW_2(end)+1:gap_LW_3(1)-1),...
    LW_in_bc_1h(gap_LW_3(end)+1:gap_LW_4(1)-1),...
    LW_in_bc_1h(gap_LW_4(end)+1:gap_snow_1(1)-1),...
    LW_in_bc_1h(gap_snow_1(end)+1:gap_LW_7(1)-1),...
    LW_in_bc_1h(gap_LW_7(end)+1:gap_snow_2(1)-1),...
    LW_in_bc_1h(gap_snow_2(end)+1:gap_snow_3(1)-1),...
    LW_in_bc_1h(gap_snow_3(end)+1:gap_LW_8(1)-1),...
    LW_in_bc_1h(gap_LW_8(end)+1:EP_end));
LWR_Subcanopy_CLM_Borden_HM = horzcat(LW_in_bc_CLM_comb(EP_start:gap_LW_1(1)-1),...
    LW_in_bc_CLM_comb(gap_LW_1(end)+1:gap_met(1)-1),...
    LW_in_bc_CLM_comb(gap_met(end)+1:gap_LW_2(1)-1),...
    LW_in_bc_CLM_comb(gap_LW_2(end)+1:gap_LW_3(1)-1),...
    LW_in_bc_CLM_comb(gap_LW_3(end)+1:gap_LW_4(1)-1),...
    LW_in_bc_CLM_comb(gap_LW_4(end)+1:gap_snow_1(1)-1),...
    LW_in_bc_CLM_comb(gap_snow_1(end)+1:gap_LW_7(1)-1),...
    LW_in_bc_CLM_comb(gap_LW_7(end)+1:gap_snow_2(1)-1),...
    LW_in_bc_CLM_comb(gap_snow_2(end)+1:gap_snow_3(1)-1),...
    LW_in_bc_CLM_comb(gap_snow_3(end)+1:gap_LW_8(1)-1),...
    LW_in_bc_CLM_comb(gap_LW_8(end)+1:EP_end));

save('MLRdata_Borden_HM.mat','LAI_Borden','PAI_Borden','Hourly_Time_Borden',...
    'Cosine_Solar_Angle_Borden','SWR_Incoming_Borden','LWR_Atmosphere_Borden',...
    'Sky_Emissivity_Borden','LWR_Subcanopy_Observations_Borden','LWR_Subcanopy_CLM_Borden_HM')