%{
Collect ingredients necessary for multi-linear regression.
- emissivity of the sky & solar angle -> description of meteorological
  conditions (insolation doesn't translate from simulation to simulation
  because of differences in latitude and season, and it's also depending on
  cloudiness)
%}
% select evaluation period
EP_2008 = 1921:4728;
EP_2009 = 10705:12864;
EP_2010 = 19465:22080;
EP_2011 = 28225:30312;
EP_2012 = 36985:39768;

% select gaps
    % due to met forcing
gap_2010 = 1200:1224;       % 20 Feb 0:00 - 21 Feb 0:00
gap_2011 = 408:456;         % 18 Jan 0:00 - 20 Jan 0:00
    % due to evaluation data
gap_LWsub_2008 = 159;       % 7 Jan 15:00
gap_LWsub_2010 = 134:137;   % 6 Jan 14:00 - 17:00
gap_LWsub_2010_2 = 1200;    % 20 Feb 0:00
gap_LWsub_2011 = 346:349;   % 15 Jan 10:00 - 13:00
gap_LWsub_2011_2 = 427:442; % 18 Jan 19:00 - 19 Jan 10:00
%{
Second gap for 2010 and 2011 each already covered by forcing data.
%}


% select variables
LAI_Seehornwald = LAI;
PAI_Seehornwald = LAI + SAI;

% 2008
Hourly_Time_Seehornwald_2008 = vertcat(time_1h(EP_2008(1):EP_2008(1)+gap_LWsub_2008-1-15),...
    time_1h(EP_2008(1)+gap_LWsub_2008-1+10:EP_2008(end)));
Cosine_Solar_Angle_Seehornwald_2008 = vertcat(Cosine_Solar_Angle(EP_2008(1):EP_2008(1)+gap_LWsub_2008-1-15),...
    Cosine_Solar_Angle(EP_2008(1)+gap_LWsub_2008-1+10:EP_2008(end)));
SWR_Incoming_Seehornwald_2008 = vertcat(SW_In_Above_Vegetation(EP_2008(1):EP_2008(1)+gap_LWsub_2008-1-15),...
    SW_In_Above_Vegetation(EP_2008(1)+gap_LWsub_2008-1+10:EP_2008(end)));
LWR_Atmosphere_Seehornwald_2008 = vertcat(LW_In_Above_Vegetation(EP_2008(1):EP_2008(1)+gap_LWsub_2008-1-15),...
    LW_In_Above_Vegetation(EP_2008(1)+gap_LWsub_2008-1+10:EP_2008(end)));

bla = 5.67*10^(-8)*Air_Temperature_Above_Vegetation.^4;
blub = LW_In_Above_Vegetation./bla;
Sky_Emissivity_Seehornwald_2008 = vertcat(blub(EP_2008(1):EP_2008(1)+gap_LWsub_2008-1-15),...
    blub(EP_2008(1)+gap_LWsub_2008-1+10:EP_2008(end)));
clear bla blub

LWR_Subcanopy_Observations_Seehornwald_2008 = vertcat(LW_in_bc_1h(EP_2008(1):EP_2008(1)+gap_LWsub_2008-1-15),...
    LW_in_bc_1h(EP_2008(1)+gap_LWsub_2008-1+10:EP_2008(end)));
LWR_Subcanopy_CLM_Seehornwald_2008 = vertcat(LW_in_bc_CLM(EP_2008(1):EP_2008(1)+gap_LWsub_2008-1-15),...
    LW_in_bc_CLM(EP_2008(1)+gap_LWsub_2008-1+10:EP_2008(end)));


% 2009
Hourly_Time_Seehornwald_2009 = time_1h(EP_2009(1):EP_2009(end));
Cosine_Solar_Angle_Seehornwald_2009 = Cosine_Solar_Angle(EP_2009(1):EP_2009(end));
SWR_Incoming_Seehornwald_2009 = SW_In_Above_Vegetation(EP_2009(1):EP_2009(end));
LWR_Atmosphere_Seehornwald_2009 = LW_In_Above_Vegetation(EP_2009(1):EP_2009(end));

bla = 5.67*10^(-8)*Air_Temperature_Above_Vegetation.^4;
blub = LW_In_Above_Vegetation./bla;
Sky_Emissivity_Seehornwald_2009 = blub(EP_2009(1):EP_2009(end));
clear bla blub

LWR_Subcanopy_Observations_Seehornwald_2009 = LW_in_bc_1h(EP_2009(1):EP_2009(end));
LWR_Subcanopy_CLM_Seehornwald_2009 = LW_in_bc_CLM(EP_2009(1):EP_2009(end));


% 2010
Hourly_Time_Seehornwald_2010 = vertcat(time_1h(EP_2010(1):EP_2010(1)+gap_LWsub_2010(1)-1-14),...
    time_1h(EP_2010(1)+gap_LWsub_2010(end)-1+8:EP_2010(1)+gap_2010(1)-1-24),...
    time_1h(EP_2010(1)+gap_2010(end)-1+1:EP_2010(end)));
Cosine_Solar_Angle_Seehornwald_2010 = vertcat(Cosine_Solar_Angle(EP_2010(1):EP_2010(1)+gap_LWsub_2010(1)-1-14),...
    Cosine_Solar_Angle(EP_2010(1)+gap_LWsub_2010(end)-1+8:EP_2010(1)+gap_2010(1)-1-24),...
    Cosine_Solar_Angle(EP_2010(1)+gap_2010(end)-1+1:EP_2010(end)));
SWR_Incoming_Seehornwald_2010 = vertcat(SW_In_Above_Vegetation(EP_2010(1):EP_2010(1)+gap_LWsub_2010(1)-1-14),...
    SW_In_Above_Vegetation(EP_2010(1)+gap_LWsub_2010(end)-1+8:EP_2010(1)+gap_2010(1)-1-24),...
    SW_In_Above_Vegetation(EP_2010(1)+gap_2010(end)-1+1:EP_2010(end)));
LWR_Atmosphere_Seehornwald_2010 = vertcat(LW_In_Above_Vegetation(EP_2010(1):EP_2010(1)+gap_LWsub_2010(1)-1-14),...
    LW_In_Above_Vegetation(EP_2010(1)+gap_LWsub_2010(end)-1+8:EP_2010(1)+gap_2010(1)-1-24),...
    LW_In_Above_Vegetation(EP_2010(1)+gap_2010(end)-1+1:EP_2010(end)));

bla = 5.67*10^(-8)*Air_Temperature_Above_Vegetation.^4;
blub = LW_In_Above_Vegetation./bla;
Sky_Emissivity_Seehornwald_2010 = vertcat(blub(EP_2010(1):EP_2010(1)+gap_LWsub_2010(1)-1-14),...
    blub(EP_2010(1)+gap_LWsub_2010(end)-1+8:EP_2010(1)+gap_2010(1)-1-24),...
    blub(EP_2010(1)+gap_2010(end)-1+1:EP_2010(end)));
clear bla blub

LWR_Subcanopy_Observations_Seehornwald_2010 = vertcat(LW_in_bc_1h(EP_2010(1):EP_2010(1)+gap_LWsub_2010(1)-1-14),...
    LW_in_bc_1h(EP_2010(1)+gap_LWsub_2010(end)-1+8:EP_2010(1)+gap_2010(1)-1-24),...
    LW_in_bc_1h(EP_2010(1)+gap_2010(end)-1+1:EP_2010(end)));
LWR_Subcanopy_CLM_Seehornwald_2010 = vertcat(LW_in_bc_CLM(EP_2010(1):EP_2010(1)+gap_LWsub_2010(1)-1-14),...
    LW_in_bc_CLM(EP_2010(1)+gap_LWsub_2010(end)-1+8:EP_2010(1)+gap_2010(1)-1-24),...
    LW_in_bc_CLM(EP_2010(1)+gap_2010(end)-1+1:EP_2010(end)));


% 2011
Hourly_Time_Seehornwald_2011 = vertcat(time_1h(EP_2011(1):EP_2011(1)+gap_LWsub_2011(1)-1-14),...
    time_1h(EP_2011(1)+gap_LWsub_2011(end)-1+8:EP_2011(1)+gap_2011(1)-1-24),...
    time_1h(EP_2011(1)+gap_2011(end)-1+1:EP_2011(end)));
Cosine_Solar_Angle_Seehornwald_2011 = vertcat(Cosine_Solar_Angle(EP_2011(1):EP_2011(1)+gap_LWsub_2011(1)-1-14),...
    Cosine_Solar_Angle(EP_2011(1)+gap_LWsub_2011(end)-1+8:EP_2011(1)+gap_2011(1)-1-24),...
    Cosine_Solar_Angle(EP_2011(1)+gap_2011(end)-1+1:EP_2011(end)));
SWR_Incoming_Seehornwald_2011 = vertcat(SW_In_Above_Vegetation(EP_2011(1):EP_2011(1)+gap_LWsub_2011(1)-1-14),...
    SW_In_Above_Vegetation(EP_2011(1)+gap_LWsub_2011(end)-1+8:EP_2011(1)+gap_2011(1)-1-24),...
    SW_In_Above_Vegetation(EP_2011(1)+gap_2011(end)-1+1:EP_2011(end)));
LWR_Atmosphere_Seehornwald_2011 = vertcat(LW_In_Above_Vegetation(EP_2011(1):EP_2011(1)+gap_LWsub_2011(1)-1-14),...
    LW_In_Above_Vegetation(EP_2011(1)+gap_LWsub_2011(end)-1+8:EP_2011(1)+gap_2011(1)-1-24),...
    LW_In_Above_Vegetation(EP_2011(1)+gap_2011(end)-1+1:EP_2011(end)));

bla = 5.67*10^(-8)*Air_Temperature_Above_Vegetation.^4;
blub = LW_In_Above_Vegetation./bla;
Sky_Emissivity_Seehornwald_2011 = vertcat(blub(EP_2011(1):EP_2011(1)+gap_LWsub_2011(1)-1-14),...
    blub(EP_2011(1)+gap_LWsub_2011(end)-1+8:EP_2011(1)+gap_2011(1)-1-24),...
    blub(EP_2011(1)+gap_2011(end)-1+1:EP_2011(end)));
clear bla blub

LWR_Subcanopy_Observations_Seehornwald_2011 = vertcat(LW_in_bc_1h(EP_2011(1):EP_2011(1)+gap_LWsub_2011(1)-1-14),...
    LW_in_bc_1h(EP_2011(1)+gap_LWsub_2011(end)-1+8:EP_2011(1)+gap_2011(1)-1-24),...
    LW_in_bc_1h(EP_2011(1)+gap_2011(end)-1+1:EP_2011(end)));
LWR_Subcanopy_CLM_Seehornwald_2011 = vertcat(LW_in_bc_CLM(EP_2011(1):EP_2011(1)+gap_LWsub_2011(1)-1-14),...
    LW_in_bc_CLM(EP_2011(1)+gap_LWsub_2011(end)-1+8:EP_2011(1)+gap_2011(1)-1-24),...
    LW_in_bc_CLM(EP_2011(1)+gap_2011(end)-1+1:EP_2011(end)));


% 2012
Hourly_Time_Seehornwald_2012 = time_1h(EP_2012(1):EP_2012(end));
Cosine_Solar_Angle_Seehornwald_2012 = Cosine_Solar_Angle(EP_2012(1):EP_2012(end));
SWR_Incoming_Seehornwald_2012 = SW_In_Above_Vegetation(EP_2012(1):EP_2012(end));
LWR_Atmosphere_Seehornwald_2012 = LW_In_Above_Vegetation(EP_2012(1):EP_2012(end));

bla = 5.67*10^(-8)*Air_Temperature_Above_Vegetation.^4;
blub = LW_In_Above_Vegetation./bla;
Sky_Emissivity_Seehornwald_2012 = blub(EP_2012(1):EP_2012(end));
clear bla blub

LWR_Subcanopy_Observations_Seehornwald_2012 = LW_in_bc_1h(EP_2012(1):EP_2012(end));
LWR_Subcanopy_CLM_Seehornwald_2012 = LW_in_bc_CLM(EP_2012(1):EP_2012(end));


save('MLRdata_Seehornwald.mat','LAI_Seehornwald','PAI_Seehornwald','Hourly_Time_Seehornwald_2008',...
    'Hourly_Time_Seehornwald_2009','Hourly_Time_Seehornwald_2010','Hourly_Time_Seehornwald_2011',...
    'Hourly_Time_Seehornwald_2012','Cosine_Solar_Angle_Seehornwald_2008',...
    'Cosine_Solar_Angle_Seehornwald_2009','Cosine_Solar_Angle_Seehornwald_2010',...
    'Cosine_Solar_Angle_Seehornwald_2011','Cosine_Solar_Angle_Seehornwald_2012',...
    'SWR_Incoming_Seehornwald_2008','SWR_Incoming_Seehornwald_2009',...
    'SWR_Incoming_Seehornwald_2010','SWR_Incoming_Seehornwald_2011',...
    'SWR_Incoming_Seehornwald_2012','LWR_Atmosphere_Seehornwald_2008',...
    'LWR_Atmosphere_Seehornwald_2009','LWR_Atmosphere_Seehornwald_2010',...
    'LWR_Atmosphere_Seehornwald_2011','LWR_Atmosphere_Seehornwald_2012',...
    'Sky_Emissivity_Seehornwald_2008','Sky_Emissivity_Seehornwald_2009',...
    'Sky_Emissivity_Seehornwald_2010','Sky_Emissivity_Seehornwald_2011',...
    'Sky_Emissivity_Seehornwald_2012','LWR_Subcanopy_Observations_Seehornwald_2008',...
    'LWR_Subcanopy_Observations_Seehornwald_2009','LWR_Subcanopy_Observations_Seehornwald_2010',...
    'LWR_Subcanopy_Observations_Seehornwald_2011','LWR_Subcanopy_Observations_Seehornwald_2012',...
    'LWR_Subcanopy_CLM_Seehornwald_2008','LWR_Subcanopy_CLM_Seehornwald_2009',...
    'LWR_Subcanopy_CLM_Seehornwald_2010','LWR_Subcanopy_CLM_Seehornwald_2011',...
    'LWR_Subcanopy_CLM_Seehornwald_2012')